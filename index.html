<!doctype html>
<html>
  <head>
    <script src="deps/three.min.js" defer></script>
    <script src="deps/Projector.js" defer></script>
    <script src="deps/stl_viewer.min.js" defer></script>
    <script src="deps/webgl_detector.js" defer></script>
    <script src="deps/OrbitControls.js" defer></script>
    <script src="deps/parser.min.js" defer></script>
    <script src="deps/TrackballControls.js" defer></script>
    <script src="deps/CanvasRenderer.js" defer></script>
    <script src="browserfs.min.js" defer></script>
    <link rel="stylesheet" href="/css/styles.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üñ®Ô∏è</text></svg>"
    />

    <script>
      const model_path = "model/model.scad"; // folder name (actually zip file) and source file name

      const outstl_name = "model_out.stl";

      const model_params = {
        xsize: {
          label: "X size",
          defaultValue: 10,
          type: "number",
        },
        ysize: {
          label: "Y size",
          defaultValue: 10,
          type: "number",
        },
        zsize: {
          label: "Z size",
          defaultValue: 10,
          type: "number",
        },
      };

      (async () => {
        if ("serviceWorker" in navigator) {
          for (const reg of await navigator.serviceWorker.getRegistrations()) {
            try {
              reg.unregister();
            } catch (e) {
              console.error(e, e.stackTrace);
            }
          }
        }
      })();
    </script>

    <script src="filesystem.js" defer></script>
    <script type="module" src="main.js" defer></script>
  </head>

  <body>
    <div class="root row">
      <div id="editor-panel" class="col">
        <button id="flip-mode">Flip</button>
        <div id="params"></div>
        <div>
          <br />
          <a href="" id="permalink">Link to current parameters</a>
        </div>
        <div class="logs-container">
          <pre><code id="logs"></code></pre>
        </div>
      </div>
      <div id="view-panel" class="col">
        <div class="text title desktop">
          <h2>Parametric Web Generator</h2>
        </div>
        <div class="text desktop">
          <span class="text-fragment">
            <a target="_blank" href="https://github.com/DSchroer/openscad-wasm"
              >WASM build</a
            >
            +
            <a target="_blank" href="https://github.com/omrips/viewstl"
              >STL Viewer</a
            >
          </span>
        </div>
        <div class="text desktop"></div>
        <div class="row text">
          <button class="button settings" id="run">Render (Ctrl+Enter)</button>
          <button class="button settings" id="kill" disabled>Kill</button>
          <div class="text-fragment" id="link-container"></div>
          <div class="text-fragment settings" id="meta"></div>
          <span class="spacer settings"></span>
          <span class="text-fragment settings"
            ><input type="checkbox" id="autorotate" checked />Rotate</span
          >
          <span class="spacer settings"></span>
        </div>
        <div id="viewer" tabindex="0"></div>
        <span id="features" class="features"></span>
      </div>
    </div>
  </body>
</html>
